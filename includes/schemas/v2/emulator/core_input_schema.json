{
  "type": "object",
  "title": "Object describing a single external input",
  "required": [
    "type"
  ],
  "properties": {
    "type": {
      "type": "string",
      "enum": ["constant", "series", "external", "random", "waveform"],
      "title": "Type of source"
    },
    "value": {
      "anyOf": [
        {
          "type": "number",
          "title": "Constant to be used as input"
        },
        {
          "type": "array",
          "title": "Constants to be used as input",
          "items": {
            "type": "number"
          }
        },
        {
          "type": "array",
          "title": "Constants to be used as input",
          "items": {
            "type": "array"
          }
        },
        {
          "type": "string",
          "value": ""
        }
      ]
    },
    "shape": {
      "type": "string",
      "enum": ["triangle", "square", "sine"],
      "title": "Shape of the waveform"
    },
    "voff": {
      "type": "array",
      "title": "Off state level",
      "items": {
        "type": "number"
      }
    },
    "von": {
      "type": "array",
      "title": "On state level",
      "items": {
        "type": "number"
      }
    },
    "tdelay": {
      "type": "array",
      "title": "First transition delay from start",
      "items": {
        "type": "number"
      }
    },
    "ton": {
      "type": "array",
      "title": "On time",
      "items": {
        "type": "number"
      }
    },
    "period": {
      "type": "array",
      "title": "Period",
      "items": {
        "type": "number"
      }
    },
    "dc_offset": {
      "type": "array",
      "title": "DC offset from the reference level",
      "items": {
        "type": "number"
      }
    },
    "amplitude": {
      "type": "array",
      "title": "Ampliture of the waveform",
      "items": {
        "type": "number"
      }
    },
    "frequency": {
      "type": "array",
      "title": "Frequency of the waveform",
      "items": {
        "type": "number"
      }
    },
    "phase": {
      "type": "array",
      "title": "Initial phase angle of the waveform",
      "items": {
        "type": "number"
      }
    },
    "duty": {
      "type": "array",
      "title": "0 for rising sawtooth,0.5 for triangle and 1 for falling sawtooth",
      "items": {
        "type": "number"
      }
    }
  },
  "allOf": [
    {
      "if": {"properties": {"type": {"enum": ["constant", "series", "external"]}}},
      "then": {"required": ["value"]}
    },
    {
      "if": {"properties": {"type": {"enum": ["file"]}}},
      "then": {"required": ["series", "file"]}
    },
    {
      "if": {"properties": {"type": {"enum": ["waveform"]}}},
      "then": {"required": ["shape"]}
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "waveform"
          },
          "shape": {
            "const": "square"
          }
        },
        "required": [
          "type",
          "shape"
        ]
      },
      "then": {
        "required": [
          "von",
          "voff",
          "tdelay",
          "ton",
          "period"
        ]
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "waveform"
          },
          "shape": {
            "const": "triangle"
          }
        },
        "required": [
          "type",
          "shape"
        ]
      },
      "then": {
        "required": [
          "dc_offset",
          "amplitude",
          "frequency",
          "phase",
          "duty"
        ]
      }
    },
    {
      "if": {
        "properties": {
          "type": {
            "const": "waveform"
          },
          "shape": {
            "const": "sine"
          }
        },
        "required": [
          "type",
          "shape"
        ]
      },
      "then": {
        "required": [
          "dc_offset",
          "amplitude",
          "frequency",
          "phase"
        ]
      }
    }
  ]
}